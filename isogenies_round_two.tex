\documentclass{article}

\include{macros}
\usepackage{fullpage}

\begin{document}
    
\section{Enumerating Isogenies of Prime Level Subvarieties}

The goal of this section is to enumerate the $\QQ$-isogeny class of simple
abelian subvarieties $A_f$ of $J_0(N)$ for $N$ prime, up to isomorphism and
2-isogenies, under experimentally mild conditions.

By Mazur and Ribet, $\TT_f=\End(A_f)$ is isomorphic to an order $\O$ of the
number field $K_f$ given by adjoining the Hecke eigenvalues to $\QQ$. Let
$m_f=[\O_{K_f}:\O]$. We prove 

\begin{theorem}
    Let $A_f$ be a simple subvariety of $J_0(N)$ with $\QQ$-isogeny $\psi:A\to
    A'$ of degree $d$ coprime to $m_f$ supported on the non-Eisenstein primes
    of odd residue characteristic then
    \[
        A' \isom A/A[\mathfrak{q}],
    \]
    for some representatives $\mathfrak{q}$ of $\Cl(\O)$.
\end{theorem}
\begin{proof}
    Let $K$ be the kernel of $\psi$. By Proposition~\ref{future}, $K=A[I]$,
    where $I=\Ann_{\TT}(K)$. Since $d\in I$ is coprime to $m_f\in
    \mathfrak{f}_{\O}$, $I$ is invertible in $\O$. Moreover, $A/[I]\isom
    A[\alpha I]$ for any $\alpha\in \TT$ by the multiplication by $\alpha$ map.
    Hence, the isomorphism class of $A$ depends only on the class of $I$ in
    $\Cl(\O)$.
\end{proof}

\begin{remark}
    Using \sage, we can that for prime level less than 400, $m_f=1$ except for
    257b, 271b, 293b, 337b, 359d, 389e. Moreover, except for 271b, $m_f$ is a
    power of 2 (which we are ignoring anyways).
\end{remark}

The goal is to now prove Proposition~\ref{future}. The idea is to show Mazur
and Helm.

\subsection{Simple Galois Modules of $J[\ell]$}\label{subsection:simple_galois_ell}

We begin by using Mazur's work to understand the $G$-subquotients of $J[\ell]$
for prime $\ell>2$. We start with a commutative algebra lemma.

\begin{lemma}\label{lemma:cherry_street}
    Let $V$ be an irreducible $R$-subquotient of $J[\ell]$. Then $\Ann_\TT V$
    is a maximal ideal of $\TT$.
\end{lemma}
\begin{proof}
    Let $I=\Ann_\TT V$. Since $\ell\in I$, $\TT/I$ is a finite ring so it
    suffices to show that $I$ is prime. Let $a,b\in \TT\setminus I$. Since $G$
    commutes with $\TT$, $aV$ and $bV$ are both $R$-submodules of $V$. By
    $R$-irreducibility of $V$, $aV=bV=V$. Consequently, $abV=V$ so $ab\notin I$
    and $I$ is prime.
\end{proof}

\begin{theorem}\label{theorem:irreducible_G_sub}
    Let $V$ be an irreducible $G$-subquotient of $J[\ell]$. Then either
    \begin{itemize}
        \item
            $V\cong_G \ZZ/\ell$ or $V\cong_G \mu_\ell$ and is unramified away
            from $\ell$ or
        \item 
            $V\cong_G J[\m]$ for some non-Eisenstein maximal $\m$ and is
            unramified away from $\ell N$.
    \end{itemize}
    So in any case, $V$ is unramified away from $\ell N$.
\end{theorem}
\begin{proof}
    This is essentially~\cite[\S 14]{mazur:eisenstein}. 

    Let $V$ be an irreducible $R$-module. By Lemma~\ref{lemma:cherry_street},
    the annihilator of $V$ in $\TT$ is a maximal ideal $\m$ of $\TT$. Then $V$
    is $R$-isomorphic to a subquotient of $J[\m]$. Either $\m$ is Eisenstein or
    $\m$ is non-Eisenstein.
    \begin{enumerate}
        \item
            If $\m$ is Eisenstein, then the action of $\TT$ factors through
            $\ZZ$, so $V$ is irreducible as a $G$-module. By~\cite[Proposition
            14.1]{mazur:eisenstein}, $J[\m]$ has a $G$-composition series
            consisting of $\ZZ/\ell$ and $\mu_\ell$ (this is what Mazur calls
            admissible) so $V$ is isomorphic as $G$-module to either $\ZZ/\ell$
            or $\mu_\ell$.
        \item
            If $\m$ is non-Eisenstein, then by~\cite[Proposition
            14.2]{mazur:eisenstein} $J[\m]$ is irreducible as a $G$-module so
            $V\cong_G J[\m]$. which is unramified away from $\ell N$
            by~\cite[Theorem 6.7]{deligne-serre}. Hence, $V\cong_G J[\m]$ is
            irreducible as a $G$-module. By~\cite[Theorem 6.7]{deligne-serre},
            $V$ is unramified away $\ell N$.
    \end{enumerate}
    This proves that any $R$-composition series of $J[\ell]$ is also a
    $G$-composition series of $J[\ell]$. The conclusion now follows from the
    Jordan-Holder Theorem.
\end{proof} 

\subsection{Finite Galois Modules are Hecke}

\begin{theorem}\label{theorem:G_modules_are_Hecke}
    Suppose $K$ is a finite $G$-module supported away from $2$. Then $K$ is
    $\TT$-stable so $K$ is an $R$-module.
\end{theorem}
\begin{proof}
    It suffices to prove this for each $\ell$-primary part. Let $\ell>2$ and
    assume $K\subseteq J(\QQbar)[\ell^\infty]$. Let
    \[
        0 = K_0 \subseteq \ldots \subseteq K_n = K
    \]
    be a maximal $G$-composition series of $K$ with composition factors $X_i =
    K_i/K_{i-1}$. We proceed by induction on on $n$ with the base
    case being the trivial $n=0$ case. 
    
    Assume $K_{s-1}$ is an $R$-module. We will show $K_s$ is an $R$-module.
    Since $K_{s-1}$ is an $R$-module, for each $t\in \TT$, we have a
    well-defined map $t:X_s\to J(\QQbar)/K_{s-1}$. The goal is to show
    $t(X_s)\subseteq X_s$. Then by~\cite[Prop. 6.1]{MR1610883}, $\TT/\ell \TT$
    is generated by $T_p$ for $p\nmid \ell N$ so it suffices to show
    $T_p(X_s)\subseteq X_s$ for prime $p\nmid \ell N$.

    Fix a prime $p\nmid \ell N$. By Corollary~\ref{corollary:unramified}, the
    Galois representation associated to $X_s$ is unramified away from $\ell N$
    so let $\Frob_p$ be a choice of Frobenius. By the proof of~\cite[Lemma
    12.6.2]{ribet-stein:mod}, the reduction map induces an isomorphism
    \[
        \tau:J(\QQ)[\ell^\infty] \riso J_{/\F_p} (\Fpbar)[\ell^\infty].
    \]
    Under this isomorphism, we have that $\Frob_p$ corresponds to the Frobenius
    $F$ in $J_{/\F_p}$ (See~\cite[\S 5.3]{ribet-stein:serre}.) Hence,
    \[
    \tau(T_p X_s) 
    = T_p\tau(X_s) 
    = (F+p/F)\tau(X_s)
    = \tau((\Frob_p+p/\Frob_p)X_s)
    \subseteq \tau(X_s)
    \]
    so $T_p X_s\subseteq X_s$, as desired.
\end{proof}
\end{document}
